<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8">
<title>Conversor SRT Profissional</title>

<style>
body{
  background:#000;
  color:#fff;
  font-family:Arial;
  padding:30px;
}
textarea{
  width:100%;
  height:220px;
  background:#111;
  color:#fff;
  padding:10px;
}
button{
  background:red;
  color:white;
  padding:12px;
  border:none;
  cursor:pointer;
  margin-top:10px;
  font-size:15px;
}
#resultadoBox{
  margin-top:20px;
}
pre{
  background:#111;
  padding:15px;
  white-space:pre-wrap;
}
.botoes{
  display:flex;
  gap:10px;
}
</style>
</head>

<body>

<h2>Conversor SRT (Áudio Contínuo)</h2>

<textarea id="texto" placeholder="Cole seu roteiro..."></textarea>

<button onclick="gerar()">GERAR SRT</button>

<div id="resultadoBox" style="display:none;">
<h3>Resultado (.srt)</h3>

<div class="botoes">
<button onclick="copiar()">Copiar</button>
<button onclick="baixar()">Baixar</button>
</div>

<pre id="resultado"></pre>
</div>

<script>

function gerar(){

let texto = document.getElementById("texto").value.trim();
let partes = dividir(texto, 480); // respeita limite

let tempo = 0;
let srt = "";

partes.forEach((p,i)=>{

let dur = tempoDeLeitura(p);

let inicio = formatar(tempo);
let fim = formatar(tempo + dur);

srt += (i+1) + "\n";
srt += inicio + " --> " + fim + "\n";
srt += p + "\n\n";

tempo += dur; // ENCadeamento perfeito
});

document.getElementById("resultado").textContent = srt;
document.getElementById("resultadoBox").style.display = "block";
}

function dividir(txt, lim){

let palavras = txt.split(" ");
let blocos = [];
let atual = "";

palavras.forEach(p=>{

if((atual+p).length <= lim){
 atual += p+" ";
}else{
 blocos.push(atual.trim());
 atual = p+" ";
}
});

if(atual) blocos.push(atual.trim());
return blocos;
}

function tempoDeLeitura(t){
return Math.ceil(t.length / 13); // fala natural
}

function formatar(s){

let h = String(Math.floor(s/3600)).padStart(2,"0");
let m = String(Math.floor(s%3600/60)).padStart(2,"0");
let sec = String(s%60).padStart(2,"0");

return `${h}:${m}:${sec},000`;
}

function copiar(){
navigator.clipboard.writeText(
document.getElementById("resultado").textContent);
alert("Copiado!");
}

function baixar(){
let blob = new Blob(
[document.getElementById("resultado").textContent],
{type:"text/plain"});

let a = document.createElement("a");
a.href = URL.createObjectURL(blob);
a.download="legenda.srt";
a.click();
}
</script>

</body>
</html>
