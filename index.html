<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8">
<title>Criador de SRT</title>

<style>
body{
  background:#000;
  color:#fff;
  font-family:Arial;
  padding:30px;
}
textarea{
  width:100%;
  height:200px;
  background:#111;
  color:#fff;
  padding:10px;
}
button{
  background:red;
  color:white;
  padding:12px;
  border:none;
  cursor:pointer;
  margin-top:10px;
  font-size:15px;
}
#resultadoBox{
  margin-top:20px;
}
pre{
  background:#111;
  padding:15px;
  white-space:pre-wrap;
}
.botoes{
  display:flex;
  gap:10px;
}
</style>
</head>

<body>

<h2>Criador de Legendas SRT</h2>

<textarea id="texto" placeholder="Cole seu texto aqui..."></textarea>

<button onclick="gerar()">GERAR SRT</button>

<div id="resultadoBox" style="display:none;">

<h3>Resultado (.srt):</h3>

<div class="botoes">
  <button onclick="copiar()">Copiar texto</button>
  <button onclick="baixar()">Baixar .srt</button>
</div>

<pre id="resultado"></pre>

</div>

<script>
function gerar(){

  let texto = document.getElementById("texto").value.trim();

  let blocos = dividirTexto(texto, 350); // tamanho ideal

  let tempoAtual = 0;
  let srt = "";

  blocos.forEach((p,i)=>{

    let duracao = calcularTempo(p);

    let ini = formatar(tempoAtual);
    tempoAtual += duracao;
    let fim = formatar(tempoAtual);

    srt += (i+1) + "\n";
    srt += ini + " --> " + fim + "\n";
    srt += p + "\n\n";

  });

  document.getElementById("resultado").textContent = srt;
  document.getElementById("resultadoBox").style.display = "block";
}

function copiar(){
  let texto = document.getElementById("resultado").textContent;
  navigator.clipboard.writeText(texto);
  alert("Texto copiado!");
}

function baixar(){
  let texto = document.getElementById("resultado").textContent;

  let blob = new Blob([texto], {type:"text/plain"});
  let link = document.createElement("a");

  link.href = URL.createObjectURL(blob);
  link.download = "legenda.srt";
  link.click();
}

/* DIVISÃO INTELIGENTE */
function dividirTexto(texto, limite){

  let partes = [];
  let inicio = 0;

  while(inicio < texto.length){

    let fim = inicio + limite;

    if(fim >= texto.length){
      partes.push(texto.slice(inicio).trim());
      break;
    }

    // volta até achar espaço ou pontuação
    while(fim > inicio && !/[\.!\?\s]/.test(texto[fim])){
      fim--;
    }

    partes.push(texto.slice(inicio, fim).trim());
    inicio = fim;
  }

  return partes;
}

function calcularTempo(texto){
  let velocidade = 15; // caracteres por segundo
  let segundos = texto.length / velocidade;
  return Math.ceil(segundos);
}

function formatar(s){

 let h = String(Math.floor(s/3600)).padStart(2,"0");
 let m = String(Math.floor(s%3600/60)).padStart(2,"0");
 let sec = String(s%60).padStart(2,"0");

 return `${h}:${m}:${sec},000`;
}
</script>

</body>
</html>
